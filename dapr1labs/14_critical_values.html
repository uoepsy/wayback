<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Hypothesis testing: the critical values approach</title>

<script src="site_libs/header-attrs-2.8/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-plus')) {
    f.classList.add('fa-minus')
    f.classList.remove('fa-plus')
} else {
    f.classList.add('fa-plus')
    f.classList.remove('fa-minus')
}
}
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/style-labs.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"><strong>DAPR1</strong></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li>
  <a href="intro_r_rstudio_year1.html">DAPR1 starts here</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Intro to data and R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01_data_types.html">1/1: Collecting data</a>
    </li>
    <li>
      <a href="02_categorical.html">1/2: Categorical data</a>
    </li>
    <li>
      <a href="03_numerical.html">1/3: Numerical data</a>
    </li>
    <li>
      <a href="04_relationships.html">1/4: Relationships</a>
    </li>
    <li>
      <a href="05_functions.html">1/5: Types of relations</a>
    </li>
    <li class="dropdown-header">1/6: Break week!</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Probability &amp; sampling
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="07_probability_basics.html">1/7: Probability basics</a>
    </li>
    <li>
      <a href="08_probability_rules.html">1/8: Probability rules!</a>
    </li>
    <li>
      <a href="09_discrete_distributions.html">1/9: Discrete random variables</a>
    </li>
    <li>
      <a href="10_continuous_distributions.html">1/10: Continuous random variables</a>
    </li>
    <li>
      <a href="11_sampling_distributions.html">1/11: Sampling distributions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Hypothesis testing
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="12_bootstrap_cis.html">2/1: Bootstrap &amp; CIs</a>
    </li>
    <li>
      <a href="13_hypothesis_testing.html">2/2: Hypothesis testing: p-values</a>
    </li>
    <li>
      <a href="14_critical_values.html">2/3: Hypothesis testing: critical values</a>
    </li>
    <li>
      <a href="15_connecting_ci_ht.html">2/4: Hypothesis testing &amp; CIs</a>
    </li>
    <li>
      <a href="16_ht_errors.html">2/5: Making decisions</a>
    </li>
    <li class="dropdown-header">2/6: Break week</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Basic tests
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="17_one_sample_mean.html">2/7: Test for one mean</a>
    </li>
    <li>
      <a href="18_two_sample_means.html">2/8: Test for two means</a>
    </li>
    <li>
      <a href="19_paired_t_test.html">2/9: Test for paired samples</a>
    </li>
    <li>
      <a href="20_chi_square.html">2/10: Chi-square</a>
    </li>
    <li>
      <a href="21_covcor.html">2/11: Covariance and correlation</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Hypothesis testing: the critical values approach</h1>

</div>


<div class="lo">
<ol style="list-style-type: decimal">
<li>Recognise the difference between a bootstrap and null distribution</li>
<li>Understand the parallel between p-values and critical values</li>
<li>Be able to perform a one-sided or two-sided hypothesis test using the critical value method</li>
<li>Understand the link between z-scores and critical values</li>
</ol>
</div>
<div id="research-question-and-data" class="section level1">
<h1>Research question and data</h1>
<p>This week we will still be using the same data as last week, to see a direct comparison between the conclusions we reached using the p-value approach with the conclusions we will reach using the critical values approach.</p>
<p>Recall that the research question was:</p>
<blockquote>
<p>Can a simple smile have an effect on punishment assigned following an infraction?</p>
</blockquote>
<div class="optional-begin">
Data: Smiles.csv<span id="opt-start-149" class="fa fa-plus optional-icon clickable" onclick="toggle_visibility(&#39;opt-body-149&#39;, &#39;opt-start-149&#39;)"></span>
</div>
<div id="opt-body-149" class="optional-body" style="display: none;">
<p>Researchers <span class="citation"><a href="#ref-LaFrance1995" role="doc-biblioref">LaFrance and Hecht</a> (<a href="#ref-LaFrance1995" role="doc-biblioref">1995</a>)</span> conducted a study to examine the effect of a smile on the leniency of disciplinary action for wrongdoers.
Participants in the experiment took on the role of members of a college disciplinary panel judging students accused of cheating.
They were given, along with a description of the offence, a picture of the “suspect” who was either smiling or had a neutral facial expression.
A leniency score (on a 10-point scale) was calculated based on the disciplinary decisions made by the participants.
The full data can be found in the <a href="https://uoepsy.github.io/data/Smiles.csv">Smiles.csv</a> dataset, also available at the following link: <a href="https://uoepsy.github.io/data/Smiles.csv" class="uri">https://uoepsy.github.io/data/Smiles.csv</a></p>
<p>The experimenters have prior knowledge that smiling has a positive influence on people, and they are testing to see if the average lenience score is higher for smiling students than it is for students with a neutral facial expression (or, in other words, that smiling students are given more leniency and milder punishments.)</p>
</div>
<p class="optional-end">
</p>
<p>Analysing the data using a threshold of <span class="math inline">\(\alpha = 0.05\)</span>, last week we concluded that:</p>
<div class="int">
<p>At a 5% significance level, we tested whether the mean leniency score for smiling students is higher than for students with a neutral expression. The p-value of the test (<span class="math inline">\(p = 0.029\)</span>) indicates that if smiling truly had no effect on leniency scores, the chance of getting a difference in mean leniency scores between smiling and neutral students as high as 0.79 is 0.029, or 3 in 100 times. The sample data provide strong evidence against the null hypothesis that smiling had no effect on leniency and in favour of the alternative.</p>
</div>
<p><br></p>
<p>This week we will perform the same test of hypothesis, shown again below, but using the equivalent method of comparing the observed statistic with critical values.
<span class="math display">\[
H_0 : \mu_s - \mu_n = 0 \\
H_1 : \mu_s - \mu_n &gt; 0
\]</span></p>
<div class="yellow">
<p><strong>Critical values</strong></p>
<p>The <em><strong>critical values</strong></em> corresponding to a significance level of <span class="math inline">\(\alpha\)</span> are the boundaries which delimit the regions leading to the rejection of the null hypothesis.</p>
<p>When the observed statistic is more extreme than the critical value, we reject the null hypothesis as such statistic would have a chance smaller than <span class="math inline">\(\alpha\)</span> of occurring when <span class="math inline">\(H_0\)</span> is true.</p>
<ul>
<li><p>The 95% critical value when <span class="math inline">\(H_1 : \mu &gt; 0\)</span> is found as the 95th percentile.</p></li>
<li><p>The 95% critical values when <span class="math inline">\(H_1 : \mu \neq 0\)</span> are two and are found as the 2.5th and 97.5th percentiles. The left critical value has a probability of 0.025 to its left, and the upper critical value has a probability of 0.025 to its right, which both sum to the desired 0.05.</p></li>
</ul>
</div>
<p>First, we read the data into R and inspect the top six rows:</p>
<pre class="r"><code>library(tidyverse)

smiles &lt;- read_csv(&#39;https://uoepsy.github.io/data/Smiles.csv&#39;)
dim(smiles)</code></pre>
<pre><code>## [1] 68  2</code></pre>
<p>We have 68 participants in the study and 2 variables. Let’s look at them:</p>
<pre class="r"><code>head(smiles)</code></pre>
<pre><code>## # A tibble: 6 x 2
##   Leniency Group
##      &lt;dbl&gt; &lt;chr&gt;
## 1      7   smile
## 2      3   smile
## 3      6   smile
## 4      4.5 smile
## 5      3.5 smile
## 6      4   smile</code></pre>
<p>Group is a categorical variable encoding which type of picture the panel was shown, either neutral or with a smile. It should be a factor:</p>
<pre class="r"><code>smiles$Group &lt;- as.factor(smiles$Group)
head(smiles)</code></pre>
<pre><code>## # A tibble: 6 x 2
##   Leniency Group
##      &lt;dbl&gt; &lt;fct&gt;
## 1      7   smile
## 2      3   smile
## 3      6   smile
## 4      4.5 smile
## 5      3.5 smile
## 6      4   smile</code></pre>
<p>Let’s investigate the distribution of the original sample:</p>
<pre class="r"><code>ggplot(smiles, aes(x = Leniency)) +
    geom_histogram(color = &#39;white&#39;, fill = &#39;lightblue&#39;, binwidth = 0.5) +
    facet_grid(Group ~ .)</code></pre>
<p><img src="14_critical_values_files/figure-html/unnamed-chunk-5-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Before continuing, let’s compute the observed statistic in the sample:</p>
<pre class="r"><code>stats &lt;- smiles %&gt;%
  group_by(Group) %&gt;%
  summarise(Count = n(), 
            M = mean(Leniency), 
            SD = sd(Leniency))
stats</code></pre>
<pre><code>## # A tibble: 2 x 4
##   Group   Count     M    SD
##   &lt;fct&gt;   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 neutral    34  4.12  1.52
## 2 smile      34  4.91  1.68</code></pre>
<p>Define</p>
<ul>
<li><span class="math inline">\(\bar x_s\)</span> = sample mean leniency score for smiling students</li>
<li><span class="math inline">\(\bar x_n\)</span> = sample mean leniency score for students with a neutral expression</li>
</ul>
<p>The observed statistic which estimates the population difference in means is:
<span class="math display">\[
\bar x_s - \bar x_n = 0.79
\]</span></p>
<p>The following code stores it in R:</p>
<pre class="r"><code>D_obs &lt;- diff(stats$M)
D_obs</code></pre>
<pre><code>## [1] 0.7941176</code></pre>
</div>
<div id="null-distribution-resampling-approach" class="section level1">
<h1>Null distribution: Resampling approach</h1>
<p>The null distribution shows the possible values of a statistic for many samples from a population in which the null hypothesis is true.</p>
<p>First, we need to load the <code>rep_randomize</code> function:</p>
<pre class="r"><code>source(&quot;https://uoepsy.github.io/files/rep_randomize.R&quot;)</code></pre>
<p>For reproducibility, I will fix the random number generator seed, so that when I run again the entire file from start to finish I will get the same results.</p>
<pre class="r"><code>set.seed(368)</code></pre>
<p>Next, I will generate 1000 randomization samples. Each of such samples will be of size <span class="math inline">\(n = 68\)</span> in which the group assignment has been shuffled.</p>
<pre class="r"><code>rand_samples &lt;- rep_randomize(smiles, columns = &#39;Group&#39;, samples = 1000)
rand_samples</code></pre>
<pre><code>## # A tibble: 68,000 x 3
##    sample Leniency Group  
##     &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;  
##  1      1      7   neutral
##  2      1      3   neutral
##  3      1      6   neutral
##  4      1      4.5 smile  
##  5      1      3.5 smile  
##  6      1      4   neutral
##  7      1      3   smile  
##  8      1      3   smile  
##  9      1      3.5 smile  
## 10      1      4.5 smile  
## # … with 67,990 more rows</code></pre>
<p>The table above has 1,000 * 68 = 68,000 rows.</p>
<p>Then, for each randomization sample, we need to compute the difference in mean leniency score for the smiling and non-smiling students.</p>
<pre class="r"><code>null_dist &lt;- rand_samples %&gt;%
  group_by(sample, Group) %&gt;%
  summarise(M = mean(Leniency)) %&gt;%
  group_by(sample) %&gt;%
  summarise(D = diff(M))

null_dist</code></pre>
<pre><code>## # A tibble: 1,000 x 2
##    sample       D
##     &lt;dbl&gt;   &lt;dbl&gt;
##  1      1 -0.0588
##  2      2 -0.265 
##  3      3  0.0294
##  4      4 -0.265 
##  5      5 -0.0882
##  6      6 -0.0294
##  7      7 -0.265 
##  8      8  0.235 
##  9      9 -0.235 
## 10     10  0.294 
## # … with 990 more rows</code></pre>
<p>We can visualise the null distribution of the difference in means and see where the observed difference falls in the distribution:</p>
<pre class="r"><code>ggplot(null_dist, aes(x = D)) +
    geom_histogram(color = &#39;white&#39;, fill = &#39;lightblue&#39;) +
    geom_vline(xintercept = D_obs, color = &#39;black&#39;, linetype = 2) +
    annotate(geom = &quot;label&quot;, x = D_obs, y = 70, label = &#39;D_obs = 0.79&#39;, 
             hjust = -0.05, size = 4, color = &#39;black&#39;, fill = &#39;white&#39;) +
    labs(x = &quot;Difference (when H0 true)&quot;)</code></pre>
<p><img src="14_critical_values_files/figure-html/unnamed-chunk-12-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>In the code above, <code>linetype = 2</code> tells R to use a dashed line. Possible other values are 1 = solid line, 3 = dotted, 4 = dash-dotted line.</p>
<p>Don’t worry about <code>annotate</code> yet. It is used to make a pretty annotation at <code>x = 0.79</code> and height <code>y = 70</code> to not interfere with the rest of the graph (you can pick any other height you wish). The text to write is provided in <code>label</code>, while <code>size</code> controls the font size, <code>color</code> the colour, and <code>fill</code> the label fill colour. The argument <code>hjust</code> is the horizontal adjustment of the text, and can range from 0 to 1.</p>
<p>We now need to divide the x-axis (Differences when H0 is true) into two intervals:</p>
<ul>
<li>one leading to the rejection of <span class="math inline">\(H_0\)</span></li>
<li>the other meaning that we do not have sufficient evidence to reject <span class="math inline">\(H_0\)</span>, i.e. the non-rejection region.</li>
</ul>
<p>First, we need to specify the significance level, i.e. the proportion of statistics from the null distribution we don’t mind sacrificing and saying H0 is false (even if they came from H0) because they are sufficiently extreme.</p>
<p>Today, we will use <span class="math inline">\(\alpha = 0.05\)</span>, as statistics that only occur 5 in 100 times under the null are rare enough for this application.</p>
<p>Next, we need to find the critical difference that cuts an area of 0.95 to its left and 0.05 to its right:</p>
<pre class="r"><code>D_crit &lt;- quantile(null_dist$D, probs = 0.95)
D_crit</code></pre>
<pre><code>##       95% 
## 0.6764706</code></pre>
<p>The critical difference, i.e. the 95th quantile of the null distribution, divides the possible values for the differences into two intervals</p>
<ul>
<li>Non-rejection region (NRR), going from <span class="math inline">\(-\infty\)</span> to 0.68</li>
<li>Rejection Region (RR), going from 0.68 to <span class="math inline">\(\infty\)</span></li>
</ul>
<p>The following code displays the rejection region as a red horizontal line and the non-rejection region as a grey horizontal line:</p>
<pre class="r"><code>ggplot(null_dist, aes(x = D)) +
    geom_histogram(color = &#39;white&#39;, fill = &#39;lightblue&#39;) +
    geom_segment(aes(x = D_crit, xend = 1.3, y = 0, yend = 0), 
                 color = &#39;red&#39;, size = 2) +
    geom_segment(aes(x = -1.4, xend = D_crit, y = 0, yend = 0), 
                 color = &#39;gray&#39;, size = 2) +
    geom_vline(xintercept = D_obs, color = &#39;black&#39;, linetype = 2) +
    geom_vline(xintercept = D_crit, color = &#39;red&#39;) +
    annotate(geom = &quot;label&quot;, x = D_obs, y = 70, label = &#39;D_obs = 0.79&#39;, 
             size = 4, color = &#39;black&#39;, fill = &#39;white&#39;, hjust = -0.05) +
    annotate(geom = &quot;label&quot;, x = D_crit, y = 50, label = &#39;D_crit = 0.68&#39;, 
             size = 4, color = &#39;red&#39;, fill = &#39;white&#39;, hjust = -0.05) +
    labs(x = &quot;Difference (when H0 true)&quot;)</code></pre>
<p><img src="14_critical_values_files/figure-html/unnamed-chunk-14-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>You see highlighted in red on the horizontal axis the differences that are more extreme than the critical value, and if the observed difference falls into that red region (the rejection region) our conclusion would be to reject the null hypothesis.</p>
<p>The grey region, instead, denotes the non-rejection region. If your observed difference falls into this grey part, you wouldn’t reject the null.</p>
<p>In our case,</p>
<div class="int">
<p>At the 5% significance level, we tested whether smiling leads, on average, to more leniency compared to non-smiling.
The observed difference in leniency means for smiling and non-smiling students is 0.79, which is larger than the critical difference 0.68 cutting a probability of 0.05 to its right.
Hence, the sample difference in leniency means provides evidence against the null and in favour of the hypothesis that smiling does, on average, increase leniency and result in milder punishments.</p>
</div>
</div>
<div id="null-distribution-theoretical-approach" class="section level1">
<h1>Null distribution: Theoretical approach</h1>
<p>We know from theory that the difference in means, when there is no difference in the population in mean leniency scores between smiling and non-smiling (i.e. when <span class="math inline">\(H_0 : \mu_s - \mu_n = 0\)</span> is true), is
<span class="math display">\[
\bar X_s - \bar X_n \sim N(0, SE), \qquad \qquad SE = \sqrt{\frac{s_s^2}{n_s} + \frac{s_n^2}{n_n}}
\]</span>
where <span class="math inline">\(s_s\)</span> and <span class="math inline">\(s_n\)</span> are the standard deviation of leniency for smiling and non-smiling students, respectively, in the original data.</p>
<p>Recall that we already computed the summary statistics for our data:</p>
<pre class="r"><code>stats</code></pre>
<pre><code>## # A tibble: 2 x 4
##   Group   Count     M    SD
##   &lt;fct&gt;   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 neutral    34  4.12  1.52
## 2 smile      34  4.91  1.68</code></pre>
<pre class="r"><code>mu_theory &lt;- 0

se_theory &lt;- sqrt(stats$SD[1]^2 / stats$Count[1] + stats$SD[2]^2 / stats$Count[2])
se_theory</code></pre>
<pre><code>## [1] 0.38898</code></pre>
<p>Let’s compare this with the standard error computed before via randomization, which was 0.4. As we can see they nicely agree!</p>
<p>We now need to find the critical value that cuts a probability of 0.95 to its left (and 0.05 to its right):</p>
<pre class="r"><code>D_crit_theory &lt;- qnorm(p = 0.95, mean = mu_theory, sd = se_theory)
D_crit_theory</code></pre>
<pre><code>## [1] 0.6398152</code></pre>
<p>Is the observed difference in means larger than the critical difference?</p>
<pre class="r"><code>D_obs &gt;= D_crit_theory</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>This shows how the theory-based approach would lead to the same conclusion. At the 5% significance level, you would reject the null hypothesis.</p>
<p>Let’s also visualise this:</p>
<p><img src="14_critical_values_files/figure-html/unnamed-chunk-19-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="exercises" class="section level1">
<h1>Exercises</h1>
<p>Imagine now the scenario where the researchers have no prior beliefs about the effect of smiling on leniency scores, and they are testing to see if facial expression has <strong>any</strong> effect (it could either increase or decrease leniency scores if a disciplinary panel will view smiling as arrogant and disrespectful).</p>
<!-- 1 -->
<div class="question-begin">
Question 1
</div>
<div class="question-body">
<p>State what the null and alternative hypothesis would have been in this scenario.</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-150" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-150&#39;, &#39;sol-start-150&#39;)"></span>
</div>
<div id="sol-body-150" class="solution-body" style="display: none;">
<p>We are testing to see if there is evidence that the average score for smiling students is less than the average score for neutral students, so the alternative hypothesis is <span class="math inline">\(\mu_s &lt; \mu_n\)</span>.</p>
<p>The null hypothesis is still “no effect”:
<span class="math display">\[
H_0 : \mu_s = \mu_n \\
H_1 : \mu_s &lt; \mu_n
\]</span></p>
<p>or, equivalently:
<span class="math display">\[
H_0 : \mu_s - \mu_n = 0 \\
H_1 : \mu_s - \mu_n &lt; 0
\]</span></p>
</div>
<p class="solution-end">
</p>
<!-- 2 -->
<div class="question-begin">
Question 2
</div>
<div class="question-body">
<p>Conduct a test of hypothesis at the <span class="math inline">\(\alpha = 0.01\)</span> significance level using the critical value method.</p>
<p><strong>Hints</strong></p>
<ol style="list-style-type: decimal">
<li><p>Remember, you can reuse the null distribution we created above!</p></li>
<li><p>Find the correct quantiles</p></li>
<li><p>Check whether the observed difference falls in the non-rejection region</p></li>
</ol>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-151" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-151&#39;, &#39;sol-start-151&#39;)"></span>
</div>
<div id="sol-body-151" class="solution-body" style="display: none;">
<p>If the “red” area in the two tails must sum to 0.01, there will be a probability of <span class="math inline">\(0.01 / 2 = 0.005\)</span> in each tail.</p>
<p>Hence, the required percentiles are the 0.5th and 99.5th percentiles. That is, we need to find (a) the quantile that has a probability of 0.005 to its left, and (b) the quantile that has a probability of 0.995 to its left and 0.005 to its right:</p>
<pre class="r"><code>D_crits &lt;- quantile(null_dist$D, probs = c(0.005, 0.995))
D_crits</code></pre>
<pre><code>##       0.5%      99.5% 
## -1.0002941  0.9119118</code></pre>
<p>The non-rejection region will be the interval from -1 to 0.91.</p>
<p>Let’s check whether the observed difference falls within the non-rejection region:</p>
<pre class="r"><code>D_obs</code></pre>
<pre><code>## [1] 0.7941176</code></pre>
<p>The observed difference in means of 0.79 falls within the interval containing 99% of the values in the null distribution of the differences.
Hence, a difference that big is deemed plausible to occur under the null hypothesis and at the 1% significance level, the observed difference does not provide sufficient evidence to reject the null hypothesis that the mean leniency for smiling students is different than for non-smiling students.</p>
</div>
<p class="solution-end">
</p>
<p><img src="14_critical_values_files/figure-html/unnamed-chunk-22-1.png" width="70%" style="display: block; margin: auto;" /></p>
<!-- 3 -->
<div class="question-begin">
Question 3
</div>
<div class="question-body">
<p><strong>Theoretical approach</strong></p>
<p>You could perform the two-sided test of hypothesis above without the need for any resampling.
To do so, you just need to original sample data and the theoretical formula, which is recalled below for convenience:</p>
<p><span class="math display">\[
\text{When }H_0\text{ is true:} \qquad
\bar X_s - \bar X_n \sim N(0, SE), \qquad  SE = \sqrt{\frac{s_s^2}{n_s} + \frac{s_n^2}{n_n}}
\]</span></p>
<p>Conduct a test of hypothesis for the two-sided alternative using <span class="math inline">\(\alpha = 0.01\)</span>, the critical value approach, and resort to the theoretical distributions.</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-152" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-152&#39;, &#39;sol-start-152&#39;)"></span>
</div>
<div id="sol-body-152" class="solution-body" style="display: none;">
<p>We know that if the null hypothesis is true, the difference in means is ditributed as a normal with zero mean and standard error:</p>
<pre class="r"><code>se_theory &lt;- sqrt(stats$SD[1]^2 / stats$Count[1] + stats$SD[2]^2 / stats$Count[2])</code></pre>
<p>The 0.005 and 0.995 quantiles for such normal distribution are:</p>
<pre class="r"><code>D_crits_theory &lt;- qnorm(p = c(0.005, 0.995), mean = 0, sd = se_theory)
D_crits_theory</code></pre>
<pre><code>## [1] -1.001946  1.001946</code></pre>
<p>We have a non-rejection region going from -1 to 1.</p>
<p>The observed difference in means is</p>
<pre class="r"><code>D_obs</code></pre>
<pre><code>## [1] 0.7941176</code></pre>
<p>At the 1% significance level, we conducted a two-sided test against the null hypothesis that the mean leniency score is the same for all smiling and non-smiling students.
The observed difference of 0.79 falls within the 0.5th and 99.5th percentiles of the distribution, meaning that, at the 1% significance level, the observed difference doesn’t provide sufficient evidence against the null hypothesis.</p>
</div>
<p class="solution-end">
</p>
<!-- 4 -->
<div class="question-begin">
Question 4
</div>
<div class="question-body">
<p><strong>Theoretical approach: Standardization</strong></p>
<p>We know that standardization makes data have a mean of 0 and standard deviation equal to 1.
Furthermore we also know that for bell-shaped distributions, 95% of the values are between the mean - 1.96 * SD and the mean + 1.96 * SD.</p>
<p>For standardized variables, 95% of the values will be between -1.96 and 1.96, because mean = 0 and SD = 1.</p>
<p><span class="math display">\[
\text{When } H_0 \text{ is true:} \qquad 
\frac{(\bar X_s - \bar X_n) - 0}{SE} \sim N(0, 1)
\]</span>
Using the standard normal distribution, check whether the observed difference falls into the rejection region of the distribution at the 5% significance level.</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-153" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-153&#39;, &#39;sol-start-153&#39;)"></span>
</div>
<div id="sol-body-153" class="solution-body" style="display: none;">
<pre class="r"><code>z_obs &lt;- (D_obs - 0) / se_theory
z_obs</code></pre>
<pre><code>## [1] 2.041538</code></pre>
<p>Let’s check that the relevant quantiles are -1.96 and 1.96:</p>
<pre class="r"><code>qnorm(p = c(0.025, 0.975), mean = 0, sd = 1)</code></pre>
<pre><code>## [1] -1.959964  1.959964</code></pre>
<p>At the 5% significance level, the observed standardized difference in means (2.04) is larger than the upper standardized critical difference in means (1.96). This leads us to reject the null hypothesis.</p>
</div>
<p class="solution-end">
</p>
<div class="red">
<p><strong>WARNING</strong></p>
<p>Do not change the significance level throughout your analysis. These exercises are made for you to practice with multiple scenarios, but you should state and fix your significance level <span class="math inline">\(\alpha\)</span> at the start of your research project and keep it the same throughout. Adjusting the significance level so that your results become significant is not good scientific practice.</p>
</div>
<!-- 5 -->
<div class="question-begin">
Question 5
</div>
<div class="question-body">
<p><strong>Theoretical approach: Another view</strong></p>
<p>We have seen before that
<span class="math display">\[
\text{When }H_0\text{ is true:} \qquad
\bar X_s - \bar X_n \sim N(0, SE), \qquad  SE = \sqrt{\frac{s_s^2}{n_s} + \frac{s_n^2}{n_n}}
\]</span></p>
<p>We also know that for bell-shaped distributions such as the normal, 95% of the values are between the mean - 1.96 * SD and the mean + 1.96 * SD.</p>
<p>In this case, 95% of the sample differences will be between <span class="math inline">\(-1.96 \cdot SE\)</span> and <span class="math inline">\(1.96 \cdot SE\)</span>.</p>
<p>If we allocate a 5% significance level to the tails of the distribution, -1.96 and 1.96 will be our critical values. So we would reject whenever the observed difference in means <span class="math inline">\(\bar x_s - \bar x_n\)</span> is larger, in absolute value, than 1.96 * SE:</p>
<p><span class="math display">\[
\text{Reject }H_0\text{ if:} \qquad | \bar x_s - \bar x_n | \geq 1.96 \cdot SE
\]</span></p>
<p>Use the following quick rule to see if it leads to the same conclusions reached previously.</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-154" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-154&#39;, &#39;sol-start-154&#39;)"></span>
</div>
<div id="sol-body-154" class="solution-body" style="display: none;">
<p>Recall the SE is computed as:</p>
<pre class="r"><code>se_theory &lt;- sqrt(stats$SD[1]^2 / stats$Count[1] + stats$SD[2]^2 / stats$Count[2])
se_theory</code></pre>
<pre><code>## [1] 0.38898</code></pre>
<p>Check whether the observed difference is either</p>
<ul>
<li>larger than the hypothesised value + 1.96 * SE</li>
<li>or smaller than the hypothesised value - 1.96 * SE</li>
</ul>
<pre class="r"><code>D_obs &gt;= 1.96 * se_theory</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code>D_obs &lt;= -1.96 * se_theory</code></pre>
<pre><code>## [1] FALSE</code></pre>
<p>Alternatively, we can make the observed difference always positive by taking the absolute value, which drops any negative sign:</p>
<pre class="r"><code>abs(D_obs) &gt;= 1.96 * se_theory</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>Hence, we reject the null hypothesis.</p>
</div>
<p class="solution-end">
</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<!-- Formatting -->
<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;">

</div>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-LaFrance1995" class="csl-entry">
LaFrance, Marianne, and Marvin A Hecht. 1995. <span>“Why Smiles Generate Leniency.”</span> <em>Personality and Social Psychology Bulletin</em> 21 (3): 207–14.
</div>
</div>
</div>

<link rel="stylesheet" href="https://uoepsy.github.io/assets/css/ccfooter.css" />
<div class="ccfooter"></div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
