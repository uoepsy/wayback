<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bootstrap for regression</title>

<script src="site_libs/header-attrs-2.8/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-plus')) {
    f.classList.add('fa-minus')
    f.classList.remove('fa-plus')
} else {
    f.classList.add('fa-plus')
    f.classList.remove('fa-minus')
}
}
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="assets/style-labs.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"><strong>DAPR2</strong></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Simple Linear Regression
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01_models.html">1/1: Functions and models</a>
    </li>
    <li>
      <a href="02_slr.html">1/2: Simple linear regression</a>
    </li>
    <li>
      <a href="03_slr_model_fit.html">1/3: Model Fit, Standardized Coefficients</a>
    </li>
    <li>
      <a href="04_slr_assumptions.html">1/4: Assumptions &amp; Diagnostics</a>
    </li>
    <li>
      <a href="05_slr_writeup.html">1/5: Writing-up</a>
    </li>
    <li class="dropdown-header">1/6: Break week</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Multiple Linear Regression
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="06_mlr.html">1/7: Basics</a>
    </li>
    <li>
      <a href="07_mlr_int.html">1/8: Interactions</a>
    </li>
    <li>
      <a href="08_mlr_assumpt.html">1/9: Assumptions &amp; Diagnostics</a>
    </li>
    <li>
      <a href="09_mlr_select.html">1/10: Model Fit, Model Comparison, Model Selection</a>
    </li>
    <li>
      <a href="10_mlr_report.html">1/11: Writing-up</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Experimental Data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="11_anova.html">2/1: ANOVA</a>
    </li>
    <li>
      <a href="11_anova.html">2/2: ANOVA (again)</a>
    </li>
    <li>
      <a href="12_factorial_anova.html">2/3: 2x2 ANOVA</a>
    </li>
    <li>
      <a href="13_multiplecomp.html">2/4: Multiple Comparisons</a>
    </li>
    <li class="dropdown-header">2/5: No exercises</li>
    <li class="dropdown-header">2/6: Break week</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Advanced Topics for LM
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="14_bootstrap_reg.html">2/7: Bootstrap</a>
    </li>
    <li>
      <a href="15_binary_logistic.html">2/8: Binary Logistic Regression</a>
    </li>
    <li>
      <a href="16_more_about_logistic.html">2/9: More About Logistic Regression</a>
    </li>
    <li>
      <a href="17_power_regression.html">2/10: Sample Size and Power Analysis</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Help
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="intro_r_rstudio.html">Getting started with R &amp; RStudio</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Bootstrap for regression</h1>

</div>


<p>When our research hypothesis involves a population slope, for example, we wish to test whether in a model such as
<span class="math display">\[
y = \beta_0 + \beta_1 x + \epsilon
\]</span>
the slope coefficient is significantly different from 0 or not.</p>
<p>However, the population slope is an example of a <em>parameter</em>, a numerical summary of the population. Typically, we do not have data for the entire population, so we can only compute a numerical summary for a sample, called a <em>statistic</em>. We use the statistic <span class="math inline">\(\widehat \beta_1\)</span> (= estimated regression slope) to estimate the unknown population parameter <span class="math inline">\(\beta_1\)</span> (= true regression slope).</p>
<p>In the past weeks we have used the results from the t-test and corresponding p-values returned by the <code>summary()</code> function. However, such test results are valid only when the regression assumptions are satisfied.</p>
<p>For example, recall the Riverview data from Semester 1:</p>
<pre class="r"><code>library(tidyverse)

riverview &lt;- read_csv(file = &quot;https://uoepsy.github.io/data/riverview.csv&quot;)

mdl &lt;- lm(income ~ 1 + education, data = riverview)
summary(mdl)</code></pre>
<pre><code>## 
## Call:
## lm(formula = income ~ 1 + education, data = riverview)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -15.809  -5.783   2.088   5.127  18.379 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  11.3214     6.1232   1.849   0.0743 .  
## education     2.6513     0.3696   7.173 5.56e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.978 on 30 degrees of freedom
## Multiple R-squared:  0.6317, Adjusted R-squared:  0.6194 
## F-statistic: 51.45 on 1 and 30 DF,  p-value: 5.562e-08</code></pre>
<p>Another key question we were able to answer by looking at the <code>summary()</code> output, was “How accurate can we expect the estimates to be?” This was given by the <em>standard error</em> (SE in short), reported in the <code>Std. Error</code> column. The SE tells us the size of a typical “estimation error,” i.e. a typical distance between an estimate for a given sample and the true but unknown population value.</p>
<p>Clearly, now you might wonder, what should we do then if there is no way to satisfy the regression assumptions by transforming variables?</p>
<p>Here’s the answer: bootstrap!</p>
<p>This week we examine bootstrapping, which is another technique for drawing inferences to the population from a regression model. This method is assumption-free and does not rely on conditions such as normality of the residuals.</p>
<p>Before continuing, this table summarises the new terms that will be explained throughout the exercises.</p>
<div class="yellow">
<p><strong>Bootstrap Terminology</strong></p>
<ul>
<li>A <em>parameter</em> is a numerical summary for the population, e.g. the population slope <span class="math inline">\(\beta_1\)</span></li>
<li>A <em>statistic</em> is a numerical summary calculated from the sample data, e.g. the estimated slope in the sample <span class="math inline">\(\widehat \beta_1\)</span></li>
<li>A <em>bootstrap sample</em> is chosen with replacement from an existing sample, using the same sample size.</li>
<li>A <em>bootstrap statistic</em> is a statistic computed for each bootstrap sample.</li>
<li>A <em>bootstrap distribution</em> collects bootstrap statistics for many bootstrap samples.</li>
</ul>
</div>
<div id="age-knowledge-and-attitudes-about-science" class="section level1">
<h1>Age, Knowledge and Attitudes About Science</h1>
<p>This week’s lab explores whether attitudes towards science and faith are related to knowledge about science and to age, using a subset of data from the 2005 Eurobarometer 63.1 survey.</p>
<p>The research question guiding this example is:</p>
<blockquote>
<p>Is age and knowledge about science associated with attitudes towards science and faith?</p>
</blockquote>
<p>We can also state this in the form of two research hypotheses:</p>
<ul>
<li>There is a significant linear relationship between people’s age and their attitudes to science and faith after accounting for their scientific knowledge.</li>
<li>There is a significant linear relationship between people’s scientific knowledge and their attitudes to science and faith after accounting for their age.</li>
</ul>
</div>
<div id="the-data" class="section level1">
<h1>The Data</h1>
<p>Download the data here: <a href="https://uoepsy.github.io/data/science-faith-attitude.csv" class="uri">https://uoepsy.github.io/data/science-faith-attitude.csv</a></p>
<p>This example uses three variables from the Eurobarometer 63.1 survey:</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:left;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>kstot</code>
</td>
<td style="text-align:left;">
Score on a science “quiz” composed of 13 true/false items.
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>toomuchscience</code>
</td>
<td style="text-align:left;">
Attitude to science and faith (question wording: “We rely too much on science and not enough on faith”; responses on a 5-point scale from strongly disagree to strongly agree).
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>age</code>
</td>
<td style="text-align:left;">
Age measured in years.
</td>
</tr>
</tbody>
</table>
<p>The science knowledge quiz has a range of 0 to 13. Its mean is about 8.7. The attitude to science and faith question has five categories, ranging from 0 to 4, with a mean of about 2.5. Age has a range of 15–93, with a mean of about 45. This is formally an ordinal variable but, in line with common practice in applied research, we regard it as continuous, as we do the other two variables as well.</p>
<div class="question-begin">
Question 1
</div>
<div class="question-body">
<ul>
<li><p>Read the data into R, and call the data <code>ebsurvey</code>. Remember, you can download the data here: <a href="https://uoepsy.github.io/data/science-faith-attitude.csv" class="uri">https://uoepsy.github.io/data/science-faith-attitude.csv</a></p></li>
<li><p>How many observations and how many variables are there?</p></li>
<li><p>Today we will be only using the <code>kstot</code>, <code>age</code>, and <code>toomuchscience</code> columns. Subset the data to only have those 3 columns.</p></li>
<li><p>Is there any missing values? If yes, remove the rows with missing values.</p></li>
</ul>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-175" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-175&#39;, &#39;sol-start-175&#39;)"></span>
</div>
<div id="sol-body-175" class="solution-body" style="display: none;">
<pre class="r"><code>library(tidyverse)

# Read the data
ebsurvey &lt;- read_csv(&#39;https://uoepsy.github.io/data/science-faith-attitude.csv&#39;)
# Inspect top 6 rows
head(ebsurvey)</code></pre>
<pre><code>## # A tibble: 6 x 7
##      v5    v6 kstot   age  male toomuchscience solveprob
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;          &lt;dbl&gt;     &lt;dbl&gt;
## 1     1     2    12    35     1              2         0
## 2     2     2    11    34     0              1         1
## 3     3     2     7    40     0             NA        NA
## 4     4     2     9    32     0              3         0
## 5     5     2     6    35     0              3         1
## 6     6     2    11    67     1             NA        NA</code></pre>
<pre class="r"><code># Check data dimensions
dim(ebsurvey)</code></pre>
<pre><code>## [1] 21886     7</code></pre>
<p>There are 21886 observations on 7 variables.</p>
<p>However, today we will be only using the <code>kstot</code>, <code>age</code>, and <code>toomuchscience</code> variables. We can subset the data:</p>
<pre class="r"><code>ebsurvey &lt;- ebsurvey %&gt;%
    select(kstot, age, toomuchscience)</code></pre>
<p>Are there any NA values in the data?</p>
<pre class="r"><code>anyNA(ebsurvey)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code># Yes, so we omit them
ebsurvey &lt;- na.omit(ebsurvey)
# Check new data dimensions
dim(ebsurvey)</code></pre>
<pre><code>## [1] 10503     3</code></pre>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 2
</div>
<div class="question-body">
<p>Give the variables more meaningful names. Rename <code>kstot</code> to <code>science_knowledge</code> and rename <code>toomuchscience</code> to <code>attitude</code>.</p>
<p><em>Hint: have a look at the help page of the function <code>rename</code>.</em></p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-176" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-176&#39;, &#39;sol-start-176&#39;)"></span>
</div>
<div id="sol-body-176" class="solution-body" style="display: none;">
<pre class="r"><code>ebsurvey &lt;- ebsurvey %&gt;%
    rename(science_knowledge = kstot,
           attitude = toomuchscience)
head(ebsurvey)</code></pre>
<pre><code>## # A tibble: 6 x 3
##   science_knowledge   age attitude
##               &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
## 1                12    35        2
## 2                11    34        1
## 3                 9    32        3
## 4                 6    35        3
## 5                 9    37        1
## 6                 5    63        2</code></pre>
</div>
<p class="solution-end">
</p>
<p><br></p>
<p>Before producing multiple regression models, it is a good idea to look at each variable separately.</p>
<div class="question-begin">
Question 3
</div>
<div class="question-body">
<p>Explore the distribution of age in years, <code>age</code>.</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-177" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-177&#39;, &#39;sol-start-177&#39;)"></span>
</div>
<div id="sol-body-177" class="solution-body" style="display: none;">
<pre class="r"><code>ggplot(ebsurvey, aes(x = age)) +
    geom_histogram(color = &#39;white&#39;, binwidth = 5) +
    labs(x = &#39;Age (years)&#39;, 
         y = &#39;Frequency&#39;)</code></pre>
<p><img src="14_bootstrap_reg_files/figure-html/unnamed-chunk-8-1.png" width="60%" style="display: block; margin: auto;" /></p>
<p>We can obtain summary statistics as follows:</p>
<pre class="r"><code>library(kableExtra)

ebsurvey %&gt;%
    summarise(Min = min(age),
              Median = quantile(age, 0.5),
              IQR = IQR(age),
              Mean = mean(age),
              SD = sd(age),
              Max = max(age)) %&gt;%
    kable(digits = 2, 
          caption = &#39;Descriptive statistics of age&#39;) %&gt;%
    kable_styling(full_width = FALSE)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-9">Table 1: </span>Descriptive statistics of age
</caption>
<thead>
<tr>
<th style="text-align:right;">
Min
</th>
<th style="text-align:right;">
Median
</th>
<th style="text-align:right;">
IQR
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
SD
</th>
<th style="text-align:right;">
Max
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
44.93
</td>
<td style="text-align:right;">
17.32
</td>
<td style="text-align:right;">
93
</td>
</tr>
</tbody>
</table>
<p>The mean age in the sample is about 45 years with a standard deviation of just over 17 years. The distribution looks approximately normal, with a slight positive skew.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 4
</div>
<div class="question-body">
<p>Explore the distribution of science knowledge quiz scores, <code>science_knowledge</code>.</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-178" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-178&#39;, &#39;sol-start-178&#39;)"></span>
</div>
<div id="sol-body-178" class="solution-body" style="display: none;">
<p>An histogram of science knowledge quiz scores is provided below:</p>
<pre class="r"><code>ggplot(ebsurvey, aes(x = science_knowledge)) +
    geom_histogram(binwidth = 1, color = &#39;white&#39;) +
    labs(x = &#39;Science knowledge quiz scores&#39;, 
         y = &#39;Frequency&#39;)</code></pre>
<p><img src="14_bootstrap_reg_files/figure-html/unnamed-chunk-10-1.png" width="60%" style="display: block; margin: auto;" /></p>
<p>We can obtain summary statistics as follows:</p>
<pre class="r"><code>ebsurvey %&gt;%
    summarise(Min = min(science_knowledge),
              Median = quantile(science_knowledge, 0.5),
              IQR = IQR(science_knowledge),
              Mean = mean(science_knowledge),
              SD = sd(science_knowledge),
              Max = max(science_knowledge)) %&gt;%
    kable(digits = 2, 
          caption = &#39;Descriptive statistics of science knowledge scores&#39;) %&gt;%
    kable_styling(full_width = FALSE)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-11">Table 2: </span>Descriptive statistics of science knowledge scores
</caption>
<thead>
<tr>
<th style="text-align:right;">
Min
</th>
<th style="text-align:right;">
Median
</th>
<th style="text-align:right;">
IQR
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
SD
</th>
<th style="text-align:right;">
Max
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
8.68
</td>
<td style="text-align:right;">
2.61
</td>
<td style="text-align:right;">
13
</td>
</tr>
</tbody>
</table>
<p>The histogram shows that the majority of values on the science knowledge quiz score cluster between about 5 and 11. There is a slight negative skew to the distribution. Overall there is little reason for concern as to the appropriateness of the variable for inclusion.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 5
</div>
<div class="question-body">
<p>Explore the distribution of attitude to science and faith scores, <code>attitude</code>.</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-179" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-179&#39;, &#39;sol-start-179&#39;)"></span>
</div>
<div id="sol-body-179" class="solution-body" style="display: none;">
<pre class="r"><code>ggplot(ebsurvey, aes(x = attitude)) +
    geom_histogram(color = &#39;white&#39;, binwidth = 1) +
    labs(x = &#39;We rely too much on science and not enough on faith&#39;, 
         y = &#39;Frequency&#39;)</code></pre>
<p><img src="14_bootstrap_reg_files/figure-html/unnamed-chunk-12-1.png" width="60%" style="display: block; margin: auto;" /></p>
<p>We can obtain summary statistics as follows:</p>
<pre class="r"><code>ebsurvey %&gt;%
    summarise(Min = min(attitude),
              Median = quantile(attitude, 0.5),
              IQR = IQR(attitude),
              Mean = mean(attitude),
              SD = sd(attitude),
              Max = max(attitude)) %&gt;%
    kable(digits = 2, 
          caption = &#39;Descriptive statistics of science attitude&#39;) %&gt;%
    kable_styling(full_width = FALSE)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-13">Table 3: </span>Descriptive statistics of science attitude
</caption>
<thead>
<tr>
<th style="text-align:right;">
Min
</th>
<th style="text-align:right;">
Median
</th>
<th style="text-align:right;">
IQR
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
SD
</th>
<th style="text-align:right;">
Max
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2.2
</td>
<td style="text-align:right;">
1.22
</td>
<td style="text-align:right;">
4
</td>
</tr>
</tbody>
</table>
<p>The mean score on the science and faith attitude variable is just over 2. There are only 5 discrete values possible in the distribution, based on the response options available, but the distribution looks approximately normal, with a slight negative skew.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 6
</div>
<div class="question-body">
<p>Visualise the pairwise relationships between your variables and explore the possible correlations.</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-180" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-180&#39;, &#39;sol-start-180&#39;)"></span>
</div>
<div id="sol-body-180" class="solution-body" style="display: none;">
<pre class="r"><code>library(patchwork)

p1 &lt;- ggplot(ebsurvey, aes(age, science_knowledge)) +
    geom_point() +
    labs(x = &#39;Age (years)&#39;,
         y = &#39;Science knowledge quiz scores&#39;)

p2 &lt;- ggplot(ebsurvey, aes(age, attitude)) +
    geom_point() +
    labs(x = &#39;Age (years)&#39;,
         y = &#39;Science attitude&#39;)

p3 &lt;- ggplot(ebsurvey, aes(science_knowledge, attitude)) +
    geom_point() +
    labs(x = &#39;Science knowledge quiz scores&#39;,
         y = &#39;Science attitude&#39;)

p1 | p2 | p3</code></pre>
<p><img src="14_bootstrap_reg_files/figure-html/unnamed-chunk-14-1.png" width="95%" style="display: block; margin: auto;" /></p>
<p>From the pairwise scatterplots, it does not seem like there is a strong linear dependence of attitude to science and faith on a person’s age and science knowledge.</p>
<p>Correlation matrix:</p>
<pre class="r"><code>cor(ebsurvey)</code></pre>
<pre><code>##                   science_knowledge         age    attitude
## science_knowledge         1.0000000 -0.12239434 -0.17634507
## age                      -0.1223943  1.00000000  0.05496583
## attitude                 -0.1763451  0.05496583  1.00000000</code></pre>
<p>In this case, the Pearson correlation coefficient between <code>age</code> and <code>science_knowledge</code> is -0.12. The correlation is relatively small in absolute terms, and we therefore have little concern about multicollinearity influencing this regression analysis.</p>
<p>The correlation between <code>attitude</code> and <code>age</code> is 0.05, while with <code>science_knowledge</code> it is -0.17. So, overall there is a very weak linear relationship.</p>
</div>
<p class="solution-end">
</p>
<p><br></p>
<p>Now that we have explored each variable by itself, we can estimate the multiple regression model.</p>
<p><span class="math display">\[
\texttt{attitude}_i
= \beta_0 
+ \beta_1 \ \texttt{science_knowledge}_i
+ \beta_2 + \texttt{age}_i
+ \epsilon_i
\]</span></p>
<p>Regression results are often presented in a table that reports the coefficient estimates, their estimated standard errors, t-scores, and levels of statistical significance.</p>
<div class="question-begin">
Question 7
</div>
<div class="question-body">
<ul>
<li>Fit the model specified above using R</li>
<li>Check for violations of the model assumptions.</li>
</ul>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-181" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-181&#39;, &#39;sol-start-181&#39;)"></span>
</div>
<div id="sol-body-181" class="solution-body" style="display: none;">
<pre class="r"><code>mdl &lt;- lm(attitude ~ science_knowledge + age, data = ebsurvey)</code></pre>
<pre class="r"><code>par(mfrow = c(2,2))
plot(mdl)</code></pre>
<p><img src="14_bootstrap_reg_files/figure-html/unnamed-chunk-17-1.png" width="95%" style="display: block; margin: auto;" /></p>
</div>
<p class="solution-end">
</p>
<p><br></p>
<p>If you are doubting that the model assumptions are satisfied, don’t throw your PC up in the air, but rather keep reading!</p>
</div>
<div id="the-bootstrap" class="section level1">
<h1>The Bootstrap</h1>
<p>The <em>bootstrap</em> is a general approach to assessing whether the sample results are statistically significant or not, which does not rely on specific distributional assumptions such as normality of the errors.
It is based on sampling repeatedly with replacement (to avoid always getting the original sample exactly) from the data at hand, and then computing the regression coefficients from each resample. We will equivalently use the word bootstrap sample or resample (for SAMPLE with REplacement).</p>
<div class="frame">
<p>The basic principle is:</p>
<center>
<p><strong>The population is to the original sample</strong></p>
<p><strong>as</strong></p>
<p><strong>the original sample is to the bootstrap samples.</strong></p>
</center>
</div>
<p>Because we only have one sample of size <span class="math inline">\(n\)</span>, and we do not have access to the data for the entire population, we consider our original sample as our best approximation to the population.
To be more precise, we assume that the population is made up of many, many copies of our original sample. Then, we take multiple samples each of size <span class="math inline">\(n\)</span> from this assumed population. This is equivalent to sampling <em>with replacement</em> from the original sample.</p>
<p><img src="images/reg-boot.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We will explain, without loss of generality, the bootstrap for regression in the simple case where our sample data consist of measurements on a response <span class="math inline">\(y\)</span> and predictor <span class="math inline">\(x\)</span> for a sample of <span class="math inline">\(n\)</span> individuals (or units):</p>
<p><span class="math display">\[
\begin{matrix}
\text{Individual, }i &amp; \text{Response, }y &amp; \text{Predictor, }x \\
1 &amp; y_1 &amp; x_1 \\
2 &amp; y_2 &amp; x_2 \\
\vdots &amp; \vdots &amp; \vdots\\
n &amp; y_n &amp; x_n \\
\end{matrix}
\]</span></p>
<p>We can write this in compact form by saying that we have sample data comprising <span class="math inline">\(n\)</span> pairs of (response, predictor) data. This is our <em>original sample</em>:
<span class="math display">\[
(y_1, x_1), (y_2, x_2), \dots, (y_n, x_n)
\]</span></p>
<p>For the original sample, we can obtain estimated intercept and slope:
<span class="math display">\[
\begin{aligned}
\widehat \beta_0 &amp;= \text{estimated intercept for original sample } (y_1, x_1), (y_2, x_2), \dots, (y_n, x_n)\\ 
\widehat \beta_1 &amp;= \text{estimated slope for original sample } (y_1, x_1), (y_2, x_2), \dots, (y_n, x_n)
\end{aligned}
\]</span></p>
<p>To obtain one <em>bootstrap sample</em> from the original sample, sample <span class="math inline">\(n\)</span> pairs with replacement from the original sample. Denote the new <span class="math inline">\(n\)</span> pairs with an asterisk. Note that we can have repetitions of pairs from the original sample:
<span class="math display">\[
(y_1, x_1)^*, (y_2, x_2)^*, \dots, (y_n, x_n)^*
\]</span></p>
<p>Then, we can fit the linear model to the data in the bootstrap sample, and compute the regression coefficients in the bootstrap sample, <span class="math inline">\(\widehat \beta_0^*\)</span> and <span class="math inline">\(\widehat \beta_1^*\)</span>. These two regression coefficients are examples of <em>bootstrap statistics</em>. We call <em>bootstrap statistic</em> any numerical summary of the <em>bootstrap sample</em>, in the same way that a statistic is a numerical summary of a sample.</p>
<p><span class="math display">\[
\begin{aligned}
\widehat \beta_0^* &amp;= \text{estimated intercept for resample } (y_1, x_1)^*, (y_2, x_2)^*, \dots, (y_n, x_n)^*\\ 
\widehat \beta_1^* &amp;= \text{estimated slope for resample } (y_1, x_1)^*, (y_2, x_2)^*, \dots, (y_n, x_n)^*
\end{aligned}
\]</span></p>
<p>Now, imagine doing this many times. That is, taking many bootstrap samples (say <span class="math inline">\(R = 1,000\)</span>), each of size <span class="math inline">\(n\)</span> individuals, and computing the regression intercept and slope for each bootstrap sample.
You will obtain <span class="math inline">\(R\)</span> bootstrap intercepts and <span class="math inline">\(R\)</span> bootstrap slopes. Denote by <span class="math inline">\(\widehat \beta_{0}^{(5)}\)</span> the bootstrap intercept in the 5th bootstrap sample. Similarly, <span class="math inline">\(\widehat \beta_{1}^{(5)}\)</span> is the bootstrap slope in the 5th bootstrap sample.
<span class="math display">\[
\widehat \beta_{0}^{(1)}, \ 
\widehat \beta_{0}^{(2)}, \dots, \ 
\widehat \beta_{0}^{(R)} \\
\widehat \beta_{1}^{(1)}, \ 
\widehat \beta_{1}^{(2)}, \dots, \ 
\widehat \beta_{1}^{(R)}
\]</span>
You can visualise the distribution of the <span class="math inline">\(R = 1,000\)</span> bootstrap intercepts and slopes with histograms:
<img src="14_bootstrap_reg_files/figure-html/unnamed-chunk-19-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="optional-begin">
This is way too much math… Make it more concrete please!<span id="opt-start-182" class="fa fa-plus optional-icon clickable" onclick="toggle_visibility(&#39;opt-body-182&#39;, &#39;opt-start-182&#39;)"></span>
</div>
<div id="opt-body-182" class="optional-body" style="display: none;">
<p>Ok, this is more applied. Consider this as the original sample of <span class="math inline">\(n = 4\)</span> individuals:</p>
<p><span class="math display">\[
\begin{matrix}
\text{Individual, }i &amp; \text{Response, }y &amp; \text{Predictor, }x \\
1 &amp; 10.2 &amp; 7 \\
2 &amp; 5.7  &amp; 4 \\
3 &amp; 8.0  &amp; 5 \\
4 &amp; 9.1  &amp; 3 \\
\end{matrix}
\]</span></p>
<p>or, more compactly, the original sample is:</p>
<p><span class="math display">\[
(10.2, 7), (5.7, 4), (8.0, 5), (9.1, 3)
\]</span></p>
<p>A bootstrap sample is obtained by sampling 4 pairs from the original sample, with replacement. One such bootstrap sample could be:
<span class="math display">\[
(8.0, 5), (5.7, 4), (8.0, 5), (9.1, 3)
\]</span></p>
<p>Then, fitting the linear model to these data, we can obtain a bootstrap intercept and bootstrap slope</p>
<pre class="r"><code>y &lt;- c(8, 5.7, 8, 9.1)
x &lt;- c(5, 4, 5, 3)
coef(lm(y ~ x))</code></pre>
<pre><code>## (Intercept)           x 
##   8.9363636  -0.2909091</code></pre>
<p><span class="math display">\[
\widehat \beta_0^* = 8.94 \qquad \widehat \beta_1^* = -0.29
\]</span></p>
<p>Now, imagine doing this many times. That is, taking many bootstrap samples (say <span class="math inline">\(R = 1,000\)</span>), each of size <span class="math inline">\(n = 4\)</span> individuals, and computing the regression intercept and slope for each bootstrap sample.
You will obtain <span class="math inline">\(R\)</span> bootstrap intercepts and <span class="math inline">\(R\)</span> bootstrap slopes.</p>
<p>You can visualise the distribution of the bootstrap intercept and slopes with histograms:
<img src="14_bootstrap_reg_files/figure-html/unnamed-chunk-21-1.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
<p class="optional-end">
</p>
<p><br></p>
<p>That sounds all nice in theory! But how do I actually do this in R? Is it difficult???</p>
<p>No, it’s super easy! Follow these steps:</p>
<p><strong>Step 1.</strong> Load the <code>car</code> library</p>
<pre class="r"><code>library(car)</code></pre>
<p><strong>Step 2.</strong> Use the <code>Boot()</code> function (do not forget the uppercase B!) which takes as arguments:</p>
<ul>
<li>the fitted model</li>
<li><code>f</code>, saying which bootstrap statistics to compute on each bootstrap sample. By default <code>f = coef</code>, returning the regression coefficients.</li>
<li><code>R</code>, saying how many bootstrap samples to compute. By default <code>R = 999</code>.</li>
<li><code>ncores</code>, saying if to perform the calculations in parallel (and more efficiently). However, this will depend on your PC, and you need to find how many cores you have by running <code>parallel::detectCores()</code> on your PC. By default the function uses <code>ncores = 1</code>.</li>
</ul>
<p><strong>Step 3.</strong> Run the code. However, please remember that the <code>Boot()</code> function does <strong>not</strong> want a model which was fitted using data with NAs. In our case we are fine because we already removed them with <code>na.omit</code>.</p>
<pre class="r"><code>boot_mdl &lt;- Boot(mdl, R = 999)</code></pre>
<p><strong>Step 4.</strong> Look at the summary of the bootstrap results:</p>
<pre class="r"><code>summary(boot_mdl)</code></pre>
<pre><code>## 
## Number of bootstrap replications R = 999 
##                     original    bootBias     bootSE    bootMed
## (Intercept)        2.7882487  1.8311e-03 0.05545034  2.7909036
## science_knowledge -0.0802763 -5.1728e-05 0.00442885 -0.0802218
## age                0.0023794 -2.5833e-05 0.00069909  0.0023376</code></pre>
<p>The above output shows, for each regression coefficient, the value in the original sample in the column <code>original</code>, and then we will focus on the <code>bootSE</code> column, which estimates the variability of the coefficient from bootstrap sample to bootstrap sample. The <code>bootSE</code> provides us the bootstrap standard error, or bootstrap SE in short. We use this to answer the key question of how accurate our estimate is.</p>
<p><strong>Step 5.</strong> Compute confidence intervals. Use your preferred confidence level, by default this is 95%:</p>
<pre class="r"><code>Confint(boot_mdl, level = 0.95, type = &quot;perc&quot;)</code></pre>
<pre><code>## Bootstrap percent confidence intervals
## 
##                       Estimate        2.5 %       97.5 %
## (Intercept)        2.788248712  2.682016848  2.898655860
## science_knowledge -0.080276256 -0.089240855 -0.071479349
## age                0.002379446  0.000962663  0.003786739</code></pre>
<p>The <code>type = "perc"</code> argument tells R to return the values that comprise 95% of all values in between them, i.e. the value with 2.5% of observations below it and the value with 2.5% of observations above it and 97.5% of observations below it.</p>
<p>If you want to make it into a nice table:</p>
<pre class="r"><code>Confint(boot_mdl, type = &quot;perc&quot;) %&gt;%
    kable(digits = 3, caption = &#39;Bootstrap 95% CIs&#39;) %&gt;%
    kable_styling(full_width = FALSE)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:tbl-boot">Table 4: </span>Bootstrap 95% CIs
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
2.5 %
</th>
<th style="text-align:right;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
2.788
</td>
<td style="text-align:right;">
2.682
</td>
<td style="text-align:right;">
2.899
</td>
</tr>
<tr>
<td style="text-align:left;">
science_knowledge
</td>
<td style="text-align:right;">
-0.080
</td>
<td style="text-align:right;">
-0.089
</td>
<td style="text-align:right;">
-0.071
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
0.004
</td>
</tr>
</tbody>
</table>
<div class="int">
<p>We are 95% confident that the population intercept is between 2.68 and 2.9.
We are 95% confident that the population slope for science knowledge is between -0.09 and -0.07.
We are 95% confident that the population slope for age is between 0.001 and 0.004.</p>
</div>
<p>The results in Table <a href="#tab:tbl-boot">4</a> report an estimate of the intercept (or constant) as equal to approximately 2.8.
The constant of a multiple regression model can be interpreted as the average expected value of the dependent variable when all of the independent variables equal zero. In this case, the independent variable science knowledge has only a handful of respondents that score zero, and no one is aged zero, so the constant by itself does not tell us much. Researchers do not often have predictions based on the intercept, so it often receives little attention. A better choice would be to mean centre age, and refit the model with a mean centred age variable!</p>
<p>The estimated value for the slope coefficient linking knowledge to attitude is estimated to be approximately -0.08. This represents the average marginal effect of knowledge on attitude, and can be interpreted as the expected change in the dependent variable on average for a one-unit increase in the independent variable, controlling for age. In this example, every increase in quiz score by one point is associated with a decrease in attitude score of about –0.08, adjusted for age.
Bearing in mind the valence of the question wording, this means that those who are more knowledgeable tend to be more favourable towards science – i.e. disagreeing with the statement.</p>
<p>The slope coefficient linking age to attitude is estimated to be approximately 0.002. This represents the average marginal effect of each additional year on attitude, and can be interpreted as the expected change in the dependent variable on average for a one-unit increase in the independent variable, controlling for science knowledge. For this example, that means that for every year older a person is, their attitude score is expected to increase by 0.002, controlling for science knowledge. This may seem like a very small effect, but remember that this is the effect of only one additional year. Bearing in mind the valence of the question wording, this means that older people tend to be less favourable towards science – i.e. agreeing with the statement.</p>
<p>The bootstrap confidence intervals table also reports that the 95% confidence intervals for both slope estimates do not include 0. This leads us to reject both null hypotheses at the 5% significance level, and conclude that there appear to be relationships for both age and science knowledge with attitude to science and faith.</p>
<p>Remember the summary of them model:</p>
<pre class="r"><code>summary(mdl)</code></pre>
<pre><code>## 
## Call:
## lm(formula = attitude ~ science_knowledge + age, data = ebsurvey)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.88643 -0.97484  0.00913  0.88427  2.21489 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        2.7882487  0.0537759  51.849  &lt; 2e-16 ***
## science_knowledge -0.0802763  0.0045095 -17.802  &lt; 2e-16 ***
## age                0.0023794  0.0006792   3.503 0.000461 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.196 on 10500 degrees of freedom
## Multiple R-squared:  0.03223,    Adjusted R-squared:  0.03204 
## F-statistic: 174.8 on 2 and 10500 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The R-squared for the model is 0.031, which means that approximately 3% of the variance in attitude is explained by science knowledge and age.</p>
<p><br></p>
<p>How can we visualise the bootstrap intercepts and slopes? They are stored in the <code>boot_mdl</code> object.</p>
<p>This will show you the <span class="math inline">\(R = 999\)</span> estimates, using head to show only the top 6.</p>
<pre class="r"><code>head(boot_mdl$t)</code></pre>
<pre><code>##      (Intercept) science_knowledge          age
## [1,]    2.860584       -0.07946250 0.0009295118
## [2,]    2.729586       -0.07512774 0.0024392332
## [3,]    2.789480       -0.08029869 0.0025441840
## [4,]    2.749536       -0.07630859 0.0024819148
## [5,]    2.913322       -0.09170225 0.0012816341
## [6,]    2.803966       -0.07888200 0.0020855342</code></pre>
<p>While this shows you the estimated intercept and slope in the original sample</p>
<pre class="r"><code>boot_mdl$t0</code></pre>
<pre><code>##       (Intercept) science_knowledge               age 
##       2.788248712      -0.080276256       0.002379446</code></pre>
<p>You can visualise the uncertainty in the estimates by plotting histograms either manually:</p>
<pre class="r"><code>plot_data &lt;- as_tibble(boot_mdl$t)
plot_data</code></pre>
<pre><code>## # A tibble: 999 x 3
##    `(Intercept)` science_knowledge      age
##            &lt;dbl&gt;             &lt;dbl&gt;    &lt;dbl&gt;
##  1          2.86           -0.0795 0.000930
##  2          2.73           -0.0751 0.00244 
##  3          2.79           -0.0803 0.00254 
##  4          2.75           -0.0763 0.00248 
##  5          2.91           -0.0917 0.00128 
##  6          2.80           -0.0789 0.00209 
##  7          2.76           -0.0803 0.00311 
##  8          2.75           -0.0787 0.00308 
##  9          2.69           -0.0733 0.00286 
## 10          2.77           -0.0795 0.00259 
## # … with 989 more rows</code></pre>
<pre class="r"><code>ggplot(plot_data, aes(science_knowledge)) +
    geom_histogram(color = &#39;white&#39;)</code></pre>
<p><img src="14_bootstrap_reg_files/figure-html/unnamed-chunk-29-1.png" width="60%" style="display: block; margin: auto;" /></p>
<p>Or using the built-in function from the <code>car</code> package, which simply takes the bootstrap results <code>boot_mdl</code>:</p>
<pre class="r"><code>hist(boot_mdl, ci = &quot;perc&quot;, legend = &quot;separate&quot;)</code></pre>
<p><img src="14_bootstrap_reg_files/figure-html/unnamed-chunk-30-1.png" width="95%" style="display: block; margin: auto;" /></p>
</div>
<div id="presenting-results" class="section level1">
<h1>Presenting results</h1>
<div class="question-begin">
Question 8
</div>
<div class="question-body">
<p>Write a short paragraph summarising the results of this lab.</p>
<p>Include:</p>
<ol style="list-style-type: decimal">
<li>A brief description of which data were used to answer which questions.</li>
<li>A plot of your variables and summary statistics.</li>
<li>Describe your model and report results</li>
<li>Interpret results in context.</li>
</ol>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-183" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-183&#39;, &#39;sol-start-183&#39;)"></span>
</div>
<div id="sol-body-183" class="solution-body" style="display: none;">
<p>We used a subset of data from the 2005 Eurobarometer 63.1 survey to investigate whether:</p>
<ul>
<li>There is a significant linear relationship between people’s age and their attitudes to science and faith after accounting for their scientific knowledge.</li>
<li>There is a significant linear relationship between people’s scientific knowledge and their attitudes to science and faith after accounting for their age.</li>
</ul>
<p>The data, excluding any missing values, include 10503 individual respondents who were measured on 3 different attributes: (1) Score on a science “quiz” composed of 13 true/false items. (2) Attitude to science and faith (question wording: “We rely too much on science and not enough on faith”; responses on a 5-point scale from strongly disagree to strongly agree). (3) Age measured in years.
Figure <a href="#fig:res-descr-plot">1</a> displays the scatterplots of the pairwise relationships between the 3 variables. From the plot and the correlation matrix, displyed in Table <a href="#tab:res-descr-cor">5</a>, it appears that there is a weak negative linear association between attitude and science knowledge, and nearly no linear association between attitude and age.</p>
<div class="figure" style="text-align: center"><span id="fig:res-descr-plot"></span>
<img src="14_bootstrap_reg_files/figure-html/res-descr-plot-1.png" alt="Pairwise scatterplots of the variables." width="95%" />
<p class="caption">
Figure 1: Pairwise scatterplots of the variables.
</p>
</div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:res-descr-cor">Table 5: </span>Correlation matrix
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
science_knowledge
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:right;">
attitude
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
science_knowledge
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
-0.122
</td>
<td style="text-align:right;">
-0.176
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
-0.122
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.055
</td>
</tr>
<tr>
<td style="text-align:left;">
attitude
</td>
<td style="text-align:right;">
-0.176
</td>
<td style="text-align:right;">
0.055
</td>
<td style="text-align:right;">
1.000
</td>
</tr>
</tbody>
</table>
<p>To answer the research hypotheses, we fitted the following regression model:
<span class="math display">\[
\text{attitude} = \beta_0 + \beta_1 \ \text{science_knowledge} + \beta_2 \ \text{age} + \epsilon
\]</span></p>
<p>Which resulted in the following estimated regression coefficients for the original sample:
<span class="math display">\[
\widehat{\text{attitude}} = 2.8 -0.08 \ \text{science_knowledge} + 0.0024 \ \text{age}
\]</span></p>
The model does not satisfy the regression assumptions, see Figure <a href="#fig:res-diag-plots">2</a>, and for this reason we will assess statistical significance using the boostrap approach with <span class="math inline">\(R = 999\)</span> resamples.
<div class="figure" style="text-align: center"><span id="fig:res-diag-plots"></span>
<img src="14_bootstrap_reg_files/figure-html/res-diag-plots-1.png" alt="Diagnostic plots" width="95%" />
<p class="caption">
Figure 2: Diagnostic plots
</p>
</div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:resboottable">Table 6: </span>Bootstrap 95% CIs
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
2.5 %
</th>
<th style="text-align:right;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
2.788
</td>
<td style="text-align:right;">
2.682
</td>
<td style="text-align:right;">
2.899
</td>
</tr>
<tr>
<td style="text-align:left;">
science_knowledge
</td>
<td style="text-align:right;">
-0.080
</td>
<td style="text-align:right;">
-0.089
</td>
<td style="text-align:right;">
-0.071
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
0.004
</td>
</tr>
</tbody>
</table>
<p>The 95% bootstrap confidence intervals are provided in Table <a href="#tab:resboottable">6</a>. These results show that there is a negative and statistically significant relationship between knowledge and attitudes. Specifically, the results show that for every additional correct quiz answer people give, we would expect a decline in attitude score of about 0.08. For age, the effect is in the opposite direction. For every additional year older a person is, they are expected to score .002 more on the attitude scale. The R-squared for the model is 0.032, which means that approximately 3% of the variance in attitude is explained by science knowledge and age. This leaves the majority of variation in attitudes unexplained by our model. Thus we conclude that respondents with greater knowledge about science also tend to be more positive about it, regardless of their age, while older people are slightly less positive, irrespective of their level of knowledge.
Further diagnostic tests should be explored to evaluate the robustness of this finding.</p>
</div>
<p class="solution-end">
</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>Adapted from:</p>
<ul>
<li>Allum, N. (2015). Learn about multiple regression in SPSS with data from the eurobarometer (63.1, jan–feb 2005). In <em>SAGE Research Methods Datasets Part 1.</em> SAGE Publications, Ltd.</li>
</ul>
<!-- Formatting -->
<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;">

</div>
</div>

<link rel="stylesheet" href="https://uoepsy.github.io/assets/css/ccfooter.css" />
<div class="ccfooter"></div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
