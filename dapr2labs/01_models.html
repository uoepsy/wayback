<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Functions and models</title>

<script src="site_libs/header-attrs-2.8/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-plus')) {
    f.classList.add('fa-minus')
    f.classList.remove('fa-plus')
} else {
    f.classList.add('fa-plus')
    f.classList.remove('fa-minus')
}
}
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/style-labs.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"><strong>DAPR2</strong></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Simple Linear Regression
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01_models.html">1/1: Functions and models</a>
    </li>
    <li>
      <a href="02_slr.html">1/2: Simple linear regression</a>
    </li>
    <li>
      <a href="03_slr_model_fit.html">1/3: Model Fit, Standardized Coefficients</a>
    </li>
    <li>
      <a href="04_slr_assumptions.html">1/4: Assumptions &amp; Diagnostics</a>
    </li>
    <li>
      <a href="05_slr_writeup.html">1/5: Writing-up</a>
    </li>
    <li class="dropdown-header">1/6: Break week</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Multiple Linear Regression
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="06_mlr.html">1/7: Basics</a>
    </li>
    <li>
      <a href="07_mlr_int.html">1/8: Interactions</a>
    </li>
    <li>
      <a href="08_mlr_assumpt.html">1/9: Assumptions &amp; Diagnostics</a>
    </li>
    <li>
      <a href="09_mlr_select.html">1/10: Model Fit, Model Comparison, Model Selection</a>
    </li>
    <li>
      <a href="10_mlr_report.html">1/11: Writing-up</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Experimental Data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="11_anova.html">2/1: ANOVA</a>
    </li>
    <li>
      <a href="11_anova.html">2/2: ANOVA (again)</a>
    </li>
    <li>
      <a href="12_factorial_anova.html">2/3: 2x2 ANOVA</a>
    </li>
    <li>
      <a href="13_multiplecomp.html">2/4: Multiple Comparisons</a>
    </li>
    <li class="dropdown-header">2/5: No exercises</li>
    <li class="dropdown-header">2/6: Break week</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Advanced Topics for LM
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="14_bootstrap_reg.html">2/7: Bootstrap</a>
    </li>
    <li>
      <a href="15_binary_logistic.html">2/8: Binary Logistic Regression</a>
    </li>
    <li>
      <a href="16_more_about_logistic.html">2/9: More About Logistic Regression</a>
    </li>
    <li>
      <a href="17_power_regression.html">2/10: Sample Size and Power Analysis</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Help
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="intro_r_rstudio.html">Getting started with R &amp; RStudio</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Functions and models</h1>

</div>


<div class="lo">
<p><strong>LEARNING OBJECTIVES</strong></p>
<ol style="list-style-type: decimal">
<li>Review the main concepts from introductory statistics.</li>
<li>Understand the concept of a function.</li>
<li>Be able to discuss what a statistical model is.</li>
<li>Understand the link between models and functions.</li>
</ol>
</div>
<div id="refresher-of-basic-terminology" class="section level1">
<h1>Refresher of basic terminology</h1>
<div class="question-begin">
Question 1
</div>
<div class="question-body">
<p>Provide a short definition for each of these terms:</p>
<ul>
<li><em>(Observational) unit</em></li>
<li><em>Variable</em></li>
<li><em>Categorical variable</em></li>
<li><em>Numeric variable</em></li>
<li><em>Response/dependent variable</em></li>
<li><em>Explanatory/independent variable</em></li>
<li><em>Observational study</em></li>
<li><em>Experiment</em></li>
</ul>
<!-- - *Treatment* -->
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-1" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-1&#39;, &#39;sol-start-1&#39;)"></span>
</div>
<div id="sol-body-1" class="solution-body" style="display: none;">
<table>
<colgroup>
<col width="33%" />
<col width="66%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Term</th>
<th align="left">Definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><em>(Observational) unit</em></td>
<td align="left">The individual entities on which data are collected.</td>
</tr>
<tr class="even">
<td align="left"><em>Variable</em></td>
<td align="left">Any characteristic recorded on the observational units.</td>
</tr>
<tr class="odd">
<td align="left"><em>Categorical variable</em></td>
<td align="left">A categorical variable places units into one of several groups. Examples are “country of birth,” “dominant hand,” and “eye colour.”</td>
</tr>
<tr class="even">
<td align="left"><em>Numeric variable</em></td>
<td align="left">A variable that records a numerical quantity for each case. For such variables standard arithmetic operations make sense. For example, average height or weight makes sense.</td>
</tr>
<tr class="odd">
<td align="left"><em>Response/dependent variable</em></td>
<td align="left">A response variable (also called a dependent variable) measures the outcome of interest in a study.</td>
</tr>
<tr class="even">
<td align="left"><em>Explanatory/independent variable</em></td>
<td align="left">Explanatory variables (also called independent variables or predictors) are used to explain changes in the response variable.</td>
</tr>
<tr class="odd">
<td align="left"><em>Observational study</em></td>
<td align="left">An observational study is a study in which the researcher does not manipulate any of the variables involved in the study, but merely records the values as they naturally exist.</td>
</tr>
<tr class="even">
<td align="left"><em>Experiment</em></td>
<td align="left">An experiment is a study in which the researcher imposes the values of the explanatory variable on the units before measuring the response variable.</td>
</tr>
</tbody>
</table>
<!-- |*Treatment* | A treatment is any level, or combination of levels, from two or more categorical variables. | -->
</div>
<p class="solution-end">
</p>
</div>
<div id="functions-and-mathematical-models" class="section level1">
<h1>Functions and mathematical models</h1>
<div class="question-begin">
Question 2
</div>
<div class="question-body">
<p>Consider the function <span class="math inline">\(y = 2 + 5 \ x\)</span>.</p>
<ul>
<li>Identify the independent variable</li>
<li>Identify the dependent variable</li>
<li>Describe in words what the function does, and compute the output for the following input:
<span class="math display">\[
x = \begin{bmatrix}
2 \\
6
\end{bmatrix}
\]</span></li>
</ul>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-2" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-2&#39;, &#39;sol-start-2&#39;)"></span>
</div>
<div id="sol-body-2" class="solution-body" style="display: none;">
<p>The function says that the <span class="math inline">\(y\)</span> value is obtained as a transformation of the <span class="math inline">\(x\)</span> value.</p>
<ul>
<li>The independent variable is <span class="math inline">\(x\)</span></li>
<li>The dependent variable is <span class="math inline">\(y\)</span></li>
<li>The <span class="math inline">\(y\)</span> value is obtained as five times <span class="math inline">\(x\)</span>, plus two.
In particular, if <span class="math inline">\(x\)</span> equals 2, the corresponding value of <span class="math inline">\(y\)</span> will be <span class="math inline">\(2 + 5 * 2 = 12\)</span>.
Similarly, if <span class="math inline">\(x\)</span> equals 6, the corresponding value of <span class="math inline">\(y\)</span> will be <span class="math inline">\(2 + 5 * 6 = 32\)</span>.
<span class="math display">\[
y = \begin{bmatrix}
2 + 5 * 2 \\
2 + 5 * 6
\end{bmatrix}
= \begin{bmatrix}
12 \\
32
\end{bmatrix}
\]</span></li>
</ul>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 3
</div>
<div class="question-body">
<p>Write down in words and in symbols the function summarising the relationship between the side of a square and its perimeter.</p>
<p><em><strong>Hint:</strong> We are interested in how the perimeter varies as a function of its side. Hence, the perimeter is the dependent variable, and the side is the independent variable.</em></p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-3" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-3&#39;, &#39;sol-start-3&#39;)"></span>
</div>
<div id="sol-body-3" class="solution-body" style="display: none;">
<p><strong>In words</strong></p>
<p>The perimeter of a square is four times the length of its side.</p>
<p><br />
<strong>In symbols</strong></p>
<p>The relationship between side and perimeter of squares is given by:
<span class="math display">\[
Perimeter = 4 \ Side
\]</span></p>
<p>If you denote by <span class="math inline">\(x\)</span> the independent variable <em>Side</em> and by <span class="math inline">\(y\)</span> the dependent variable <em>Perimeter</em>, this can be written as
<span class="math display">\[
y = 4 \ x
\]</span></p>
</div>
<p class="solution-end">
</p>
<p>In today’s lab you will compute the output of functions and plot them. To do so, you will need functionality from the tidyverse package such as <code>tibble()</code>, <code>mutate()</code>, and <code>ggplot()</code>.</p>
<div class="question-begin">
Question 4
</div>
<div class="question-body">
<p>Load the tidyverse package.</p>
<p>Create a data set called <code>squares</code> containing the perimeter of squares having sides of length <span class="math inline">\(0, 2, 5, 9\)</span> metres.</p>
<p><em><strong>Hint:</strong> Remember that to combine multiple numbers together we use the function <code>c()</code>.</em></p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-4" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-4&#39;, &#39;sol-start-4&#39;)"></span>
</div>
<div id="sol-body-4" class="solution-body" style="display: none;">
<pre class="r"><code>library(tidyverse)

squares &lt;- tibble(
  side = c(0, 2, 5, 9),
  perimeter = 4 * side
)

squares</code></pre>
<pre><code>## # A tibble: 4 x 2
##    side perimeter
##   &lt;dbl&gt;     &lt;dbl&gt;
## 1     0         0
## 2     2         8
## 3     5        20
## 4     9        36</code></pre>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 5
</div>
<div class="question-body">
<p>Plot the <code>squares</code> data as points.</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-5" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-5&#39;, &#39;sol-start-5&#39;)"></span>
</div>
<div id="sol-body-5" class="solution-body" style="display: none;">
<pre class="r"><code>ggplot(data = squares, aes(x = side, y = perimeter)) +
  geom_point() +
  labs(x = &#39;Side (m)&#39;, y = &#39;Perimeter (m)&#39;)</code></pre>
<p><img src="01_models_files/figure-html/unnamed-chunk-2-1.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
<p class="solution-end">
</p>
<p>Now, instead of just 4 points, we will obtain many more, one hundred, and use them to visualise the relationship between side and perimeter of squares.</p>
<div class="question-begin">
Question 6
</div>
<div class="question-body">
<p>Create a sequence of one hundred side lengths (x) going from 0 to 3 metres.</p>
<p>Compute the corresponding perimeters (y).</p>
<p>Plot the side and perimeter data as points on a graph.</p>
<p>Visualise the functional relationship between side and perimeter of squares. To do so, use the function <code>geom_line()</code> to connect the computed points with lines.</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-6" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-6&#39;, &#39;sol-start-6&#39;)"></span>
</div>
<div id="sol-body-6" class="solution-body" style="display: none;">
<p>Let’s start by creating the side and perimeter data:</p>
<pre class="r"><code>squares_grid &lt;- tibble(
  side = seq(0, 3, length.out = 100),
  perimeter = 4 * side
)</code></pre>
<p>Plot the individual points:</p>
<pre class="r"><code>ggplot(data = squares_grid, aes(x = side, y = perimeter)) +
  geom_point() +
  labs(x = &#39;Side (m)&#39;, y = &#39;Perimeter (m)&#39;, title = &#39;Perimeter = 4 Side&#39;)</code></pre>
<p><img src="01_models_files/figure-html/unnamed-chunk-4-1.png" width="60%" style="display: block; margin: auto;" /></p>
<p>Visualise the functional relationship by connecting the individual points with lines:</p>
<pre class="r"><code>ggplot(data = squares_grid, aes(x = side, y = perimeter)) +
  geom_line(colour = &#39;blue&#39;) +
  labs(x = &#39;Side (m)&#39;, y = &#39;Perimeter (m)&#39;, title = &#39;Perimeter = 4 Side&#39;)</code></pre>
<p><img src="01_models_files/figure-html/unnamed-chunk-5-1.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
<p class="solution-end">
</p>
<p>The function <span class="math inline">\(y = 4 \ x\)</span> that you plotted above is an example of a function representing a mathematical model.</p>
<p>We typically validate a model using experimental data.
However, we all know how squares work and that two squares with the same side will have the same perimeter. Hence this is a <strong>deterministic model</strong> as it is a model of an <strong>exact relationship</strong>.</p>
<div class="question-begin">
Question 7
</div>
<div class="question-body">
<p>The Scottish National Gallery kindly provided us with measurements of side and perimeter (in metres) for a sample of 10 square paintings.</p>
<p>The data are provided below:</p>
<pre class="r"><code>sng &lt;- tibble(
  side = c(1.3, 0.75, 2, 0.5, 0.3, 1.1, 2.3, 0.85, 1.1, 0.2),
  perimeter = c(5.2, 3.0, 8.0, 2.0, 1.2, 4.4, 9.2, 3.4, 4.4, 0.8)
)</code></pre>
<p>Plot the mathematical model of the relationship between side and perimeter for squares, and superimpose on top the experimental data from the Scottish National Gallery.</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-7" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-7&#39;, &#39;sol-start-7&#39;)"></span>
</div>
<div id="sol-body-7" class="solution-body" style="display: none;">
<pre class="r"><code>sng &lt;- tibble(
  side = c(1.3, 0.75, 2, 0.5, 0.3, 1.1, 2.3, 0.85, 1.1, 0.2),
  perimeter = c(5.2, 3.0, 8.0, 2.0, 1.2, 4.4, 9.2, 3.4, 4.4, 0.8)
)

ggplot() +
  geom_line(data = squares_grid, aes(x = side, y = perimeter), colour = &#39;blue&#39;) +
  geom_point(data = sng, aes(x = side, y = perimeter), colour = &#39;black&#39;, 
             alpha = 0.5, size = 3) +
  labs(x = &#39;Side (m)&#39;, y = &#39;Perimeter (m)&#39;)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:squares-scatterplot"></span>
<img src="01_models_files/figure-html/squares-scatterplot-1.png" alt="The exact relationship between side and perimeter of squares." width="60%" />
<p class="caption">
Figure 1: The exact relationship between side and perimeter of squares.
</p>
</div>
<p>The above plot shows perfect agreement between the observed data and the model.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 8
</div>
<div class="question-body">
<p>Use the mathematical model to predict the perimeter of a painting with a side of 1.5 metres.</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-8" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-8&#39;, &#39;sol-start-8&#39;)"></span>
</div>
<div id="sol-body-8" class="solution-body" style="display: none;">
<p>We do not have a painting with a side of 1.5 metres within the random sample of paintings from the Scottish National Gallery.
We predict the perimeter of an unobserved squared painting having a 1.5 metre side using the mathematical model.</p>
<p>You can obtained this prediction either using a visual approach or an algebraic one.</p>
<p><br>
<strong>Visual approach</strong></p>
<p><img src="01_models_files/figure-html/unnamed-chunk-7-1.png" width="60%" style="display: block; margin: auto;" /></p>
<p>Sometimes we can directly read a predicted value from the graph of the functional relationship.</p>
<p>Consider the plot created in the previous question. First, we need to check where x = 1.5. Then, we draw a vertical dashed line until it meets the blue line. The y value corresponding to x = 1.5 can be read off the y-axis.</p>
<p>However, in this case it is not that easy to read it from the drawing… Let’s try the next approach.</p>
<p><br>
<strong>Algebraic approach</strong></p>
<p>You can substitute the x value in the formula and calculate the corresponding y value.
<span class="math display">\[
y = 4 \ x = 4 \ (1.5) = 6
\]</span></p>
<p><br>
We might write this up as:</p>
<div class="int">
<p>The predicted perimeter of squared paintings having a 1.5m side is 6m.</p>
</div>
<p><strong>NOTE</strong>: Don’t forget to always include the measurement units when reporting/writing-up results!</p>
</div>
<p class="solution-end">
</p>
</div>
<div id="statistical-models" class="section level1">
<h1>Statistical models</h1>
<p>Consider now the relationship between height (in inches) and handspan (in cm). <span class="citation"><a href="#ref-Utts2015" role="doc-biblioref">Utts and Heckard</a> (<a href="#ref-Utts2015" role="doc-biblioref">2015</a>)</span> provides data for a sample of 167 students which reported their height and handspan as part of a class survey.</p>
<div class="optional-begin">
Data: handheight.csv. Click the plus to expand →<span id="opt-start-9" class="fa fa-plus optional-icon clickable" onclick="toggle_visibility(&#39;opt-body-9&#39;, &#39;opt-start-9&#39;)"></span>
</div>
<div id="opt-body-9" class="optional-body" style="display: none;">
<p><strong>Download link</strong></p>
<p><a href="https://uoepsy.github.io/data/handheight.csv" target="_blank">Download the data here</a></p>
<p><strong>Description</strong></p>
<p>The data set records the height and handspan reported by a random sample of 167 students as part of a class survey <span class="citation">(<a href="#ref-Utts2015" role="doc-biblioref">Utts and Heckard 2015</a>)</span>.</p>
<p>The variables are:</p>
<ul>
<li><code>height</code>, measured in inches</li>
<li><code>handspan</code>, measured in centimetres</li>
</ul>
<p><strong>Preview</strong></p>
<p>The first six rows of the data are:</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
height
</th>
<th style="text-align:center;">
handspan
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;width: 10em; ">
68
</td>
<td style="text-align:center;width: 10em; ">
21.5
</td>
</tr>
<tr>
<td style="text-align:center;width: 10em; ">
71
</td>
<td style="text-align:center;width: 10em; ">
23.5
</td>
</tr>
<tr>
<td style="text-align:center;width: 10em; ">
73
</td>
<td style="text-align:center;width: 10em; ">
22.5
</td>
</tr>
<tr>
<td style="text-align:center;width: 10em; ">
64
</td>
<td style="text-align:center;width: 10em; ">
18.0
</td>
</tr>
<tr>
<td style="text-align:center;width: 10em; ">
68
</td>
<td style="text-align:center;width: 10em; ">
23.5
</td>
</tr>
<tr>
<td style="text-align:center;width: 10em; ">
59
</td>
<td style="text-align:center;width: 10em; ">
20.0
</td>
</tr>
</tbody>
</table>
</div>
<p class="optional-end">
</p>
<div class="question-begin">
Question 9
</div>
<div class="question-body">
<p>Read the handheight data into R and name the data set <code>handheight</code>.</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-10" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-10&#39;, &#39;sol-start-10&#39;)"></span>
</div>
<div id="sol-body-10" class="solution-body" style="display: none;">
<pre class="r"><code>handheight &lt;- read_csv(file = &#39;https://uoepsy.github.io/data/handheight.csv&#39;)
head(handheight)</code></pre>
<pre><code>## # A tibble: 6 x 2
##   height handspan
##    &lt;dbl&gt;    &lt;dbl&gt;
## 1     68     21.5
## 2     71     23.5
## 3     73     22.5
## 4     64     18  
## 5     68     23.5
## 6     59     20</code></pre>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 10
</div>
<div class="question-body">
<p>Investigate how handspan varies as a function of height for the students in the sample.</p>
<p>Do you notice any outliers or points that do not fit with the pattern in the rest of the data?</p>
<p>Comment on any main differences you notice with the relationship between side and perimeter of squares.</p>
<p><em><strong>Hint:</strong> Use a scatterplot to visualise the relationship between two numeric variables.</em></p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-11" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-11&#39;, &#39;sol-start-11&#39;)"></span>
</div>
<div id="sol-body-11" class="solution-body" style="display: none;">
<p>The <code>handheight</code> data set contains two variables, height and handspan, which are both numeric and continuous. We display the relationship between two numeric variables with a scatterplot.</p>
<p>We can also add marginal boxplots for each variable using the package <code>ggExtra</code>. Before using the package, make sure you have it installed via <code>install.packages('ggExtra')</code>.</p>
<pre class="r"><code>library(ggExtra)

plt &lt;- ggplot(handheight, aes(x = height, y = handspan)) +
  geom_point(size = 3, alpha = 0.5) +
  labs(x = &#39;Height (in.)&#39;, y = &#39;Handspan (cm)&#39;)

ggMarginal(plt, type = &#39;boxplot&#39;)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:handheight-scatterplot"></span>
<img src="01_models_files/figure-html/handheight-scatterplot-1.png" alt="The statistical relationship between height and handspan." width="60%" />
<p class="caption">
Figure 2: The statistical relationship between height and handspan.
</p>
</div>
<p>Outliers are extreme observations that do not seem to fit with the rest of the data. This could either be:</p>
<ul>
<li><em>marginally</em> along one axis: points that have an unusual (too high or too low) x-coordinate or y-coordinate;</li>
<li><em>jointly</em>: observations that do not fit with the rest of the point cloud.</li>
</ul>
<p>The boxplots in Figure <a href="#fig:handheight-scatterplot">2</a> do not highlight any outliers in the marginal distributions of height and handspan.
Furthermore, from the scatterplot we do not notice any extreme observations or points that do not fit with the rest of the point cloud.</p>
<p>We notice a moderate, positive (that is, increasing) linear relationship between height and handspan.</p>
<p>Recall Figure <a href="#fig:squares-scatterplot">1</a>, displaying the relationship between side and perimeters of squares.
In the plot we notice two points on top of each other, reflecting the fact that two squares having the same side will always have the same perimeter.
In fact, the data from the Scottish National Gallery include two squared paintings with a side of 1.1m, both having a measured perimeter of 4.4m.</p>
<p>Figure <a href="#fig:handheight-scatterplot">2</a>, instead, displays the relationship between height and handspan of a sample of students. The first thing that grabs our attention is the fact that students having the same height do not necessarily have the same handspan. Rather, we clearly see a variety of handspan values for students all having a height of, for example, 70in. To be more precise, the seven students who are 70 in. tall all have differing handspans.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 11
</div>
<div class="question-body">
<p>Using the following command, superimpose on top of the scatterplot a best-fit line describing how handspan varies as a function of height.
For the moment, the argument <code>se = FALSE</code> tells R to not display uncertainty bands.</p>
<pre><code>geom_smooth(method = lm, se = FALSE)</code></pre>
<p>Comment on any differences you notice with the line summarising the linear relationship between side and perimeter.</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-12" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-12&#39;, &#39;sol-start-12&#39;)"></span>
</div>
<div id="sol-body-12" class="solution-body" style="display: none;">
<pre class="r"><code>ggplot(handheight, aes(x = height, y = handspan)) +
  geom_point(size = 3, alpha = 0.5) +
  geom_smooth(method = lm, se = FALSE) +
  labs(x = &#39;Height (in.)&#39;, y = &#39;Handspan (cm)&#39;)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:handheight-fitted-model"></span>
<img src="01_models_files/figure-html/handheight-fitted-model-1.png" alt="The best-fit line." width="60%" />
<p class="caption">
Figure 3: The best-fit line.
</p>
</div>
<p>The line representing the relationship between side and perimeter of squares is able to predict the actual perimeter value from the measurement of the side of a square.
This is possible because the relationship between side and perimeter is an <strong>exact</strong> one.
That is, any squares having the same side will have the same perimeter, and there will be no variation in those values.</p>
<p>The line that best fits the relationship between height and handspan, instead, is only able to predict the <strong>average</strong> handspan for a given value of height.
This is because there will be a distribution of handspans at each value of height.
The line will fit the trend/pattern in the values, but there will be individual-to-individual variability that we must accept around that average pattern.</p>
</div>
<p class="solution-end">
</p>
<p>The mathematical model
<span class="math display">\[
Perimeter = 4 \ Side
\]</span>
or, equivalently,
<span class="math display">\[
y = 4 \ x
\]</span>
represents the exact relationship between side and perimeter of squares.</p>
<p>Contrary to the relationship represented by the mathematical model above, the relationship between height and handspan shows deviations from the “average pattern.” Hence, we need to create a model that allows for deviations from the linear relationship. This is called a statistical model.</p>
<p>A statistical model includes <strong>both</strong> a deterministic function and a random error term:
<span class="math display">\[
Handspan = \beta_0 + \beta_1 \ Height + \epsilon
\]</span>
or, in short,
<span class="math display">\[
y = \underbrace{\beta_0 + \beta_1 \ x}_{f(x)} + \underbrace{\epsilon}_{\text{random error}}
\]</span></p>
<p>The deterministic function need not be linear if the scatterplot displays signs of nonlinearity.
In the equation above, the terms <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are numbers specifying where the line going through the data meets the y-axis and its slope (rate of increase/decrease).</p>
<div class="question-begin">
Question 12
</div>
<div class="question-body">
<p>The line of best-fit is given by:<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>
<span class="math display">\[
\widehat{Handspan} = -3 + 0.35 \ Height
\]</span></p>
<p>What is your best guess for the handspan of a student who is 73in tall?</p>
<p>And for students who are 5in?</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-13" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-13&#39;, &#39;sol-start-13&#39;)"></span>
</div>
<div id="sol-body-13" class="solution-body" style="display: none;">
<p>The predicted average handspan for students who are 73in tall is <span class="math inline">\(-3 + 0.35 * 73 = 22.55\)</span>cm.</p>
<p>The predicted average handspan for students who are 5in tall is <span class="math inline">\(-3 + 0.35 * 5 = -1.25\)</span>cm.
But wait, handspan can not be negative… This does not make any sense!
That’s right, we went too far off the range of the available data on heights, which were between 57in and 78in. We extrapolated. This is very dangerous…</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-11"></span>
<img src="https://imgs.xkcd.com/comics/extrapolating.png" alt="Source: Randall Munroe, xkcd.com" width="60%" />
<p class="caption">
Figure 4: Source: Randall Munroe, xkcd.com
</p>
</div>
</div>
<p class="solution-end">
</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;">

</div>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Utts2015" class="csl-entry">
Utts, Jessica M, and Robert F Heckard. 2015. <em>Mind on Statistics</em>. Cengage Learning.
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Yes, the error term is gone. This is because the line of best-fit gives you the prediction of the average handspan for a given height, and not the individual handspan of a person, which will almost surely be different from the prediction of the line.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

<link rel="stylesheet" href="https://uoepsy.github.io/assets/css/ccfooter.css" />
<div class="ccfooter"></div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
